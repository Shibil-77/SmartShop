<!DOCTYPE html>
<html lang="en">

    <%- include('../inclueds/head.ejs'); %>

<body>

    <%- include('../inclueds/navbar.ejs'); %>

<div class="breadcrumbs">
<div class="container">
<div class="row">
<div class="col-12">
<div class="bread-inner">
<ul class="bread-list">
<li><a href="/">Home<i class="ti-arrow-right"></i></a></li>
<li class="active"><a href="/cartList">Cart</a></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="shopping-cart section">
<div class="container">
<div class="row">
    <% cartData.forEach(cartData => { %>
<div class="col-lg-8">
    <!-- catr ================= -->
<div class="shopping-cart-single">
 <div class="row">
<div class="col-lg-2">
<img src="/img/product/<%-cartData.ProductId.moreImage[0] %>" alt="">
</div>
<div class="col-lg-10 my-auto">
<div class="d-flex justify-content-between cart-title">
<h6><%-cartData.ProductId.Name %></h6>
<a href="/deletecart/<%=cartData.arrayId %>"><i class="fal fa-times"></i></a>
</div>
<div class="d-flex justify-content-between mt-4">
<div class="cart-price my-auto ">
<p>Total</p> <input type="number" name="quant[1]" style="color:#32B87D; font-weight:700; border:none; background-color:#F6F7FB;" ; class="input-number" readonly id="<%=cartData.ProductId.id %>totalAmount" data-min="1" data-max="1000" value="<%=cartData.totalAmount %>">
<p>Price</p><b><%-cartData.ProductId.Price %>
</div>
<div class="row g-0 cart-qty">
<div class="col-auto ">
<a onclick="lessCartquantity('<%=cartData.ProductId.id %>','<%=cartData.ProductId.Price %>')" >
<button class=" cat-qty-btn"><i class="fal fa-minus"></i></button>
</a>
</div>
<div class="col-auto">
<input type="text" name="quant[1]" class="input-number" readonly id="<%=cartData.ProductId.id %>" data-min="1" data-max="1000" value=" <%=cartData.quantity %>">
</div>
<div class="col-auto ">
<a onclick="Cartquantity('<%=cartData.ProductId.id %>','<%=cartData.ProductId.Price %>')" >
<button class=" cat-qty-btn"><i class="fal fa-plus"></i></button>
</a>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<% }) %>
<!-- cart end ============ -->

<div class="col-lg-3">
<div class="cart-total-amount">
<form action="/checkout" method="post">
<ul>
<li>Cart Subtotal<span><%-cartData.totalBill%></span></li>
<li>Shipping<span>Free</span></li>
<li>Tax<span>$00.00</span></li>
<li class="last">You Pay<span><input type="number" name="totalBill" style=" background-color:#F6F7FB;   color:#32B87D; font-weight:700;  border:none;" class="input-number"  id="totalBill" data-min="1" readonly data-max="1000" value="<%=cartData.totalBill%>"></span></li>
</ul>
<div class="checkout-section">
<input type="submit" class="btn checkout-btn" value="Continue shopping">
<!-- <a type="submit" >Checkout</a> -->
</div>
</form>
</div>
</div>

</div>
</div>
</div>
</div>
<%- include('../inclueds/footer.ejs'); %>

<%- include('../inclueds/end.ejs'); %>

<script>
const Cartquantity=(cartId,Price)=>{
    $.ajax({
     url:'/Cartquantity/'+cartId,
     method: 'get',
     success:(response)=>{
         if(response.status){
          let conut = document.getElementById(cartId).value
            conut++
            document.getElementById(cartId).value =  conut
            let totalAmount = parseInt(document.getElementById(cartId+'totalAmount').value)  
            document.getElementById(cartId+'totalAmount').value = Price*conut
            let totalBillData=document.getElementById('totalBill').value 
                console.log(totalBillData);
                document.getElementById('totalBill').value =Number(totalBillData)+Number(Price)
         }
     }
    })
}
</script>

<script>
    const lessCartquantity=(cartId,Price)=>{
        $.ajax({
         url:'/lessCartquantity/'+cartId,
         method: 'get',
         success:(response)=>{
             if(response.status){
                let  conut = document.getElementById(cartId).value
                if(conut>0){
                conut--
                document.getElementById(cartId).value =  conut
                let totalAmount = document.getElementById(cartId+'totalAmount').value
                document.getElementById(cartId+'totalAmount').value = totalAmount-Price
                let totalBillData=document.getElementById('totalBill').value 
                console.log(totalBillData);
                document.getElementById('totalBill').value =totalBillData-Price
                }
               }else if(response.error){
               console.log("hello");  
              }
         }
        })
    }
</script>

</body>
</html>